# å¸¸è§é—®é¢˜

æœ¬æ–‡æ¡£è®°å½•å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚

---

## ğŸ”§ ç¼–è¯‘ç›¸å…³é—®é¢˜

### Q1: Gradleç‰ˆæœ¬ä¸å…¼å®¹

**ç°è±¡**:
````
The minimum compatible Gradle version is 8.5.
````

**è§£å†³æ–¹æ¡ˆ**:

1. **ä¿®æ”¹gradle-wrapper.properties**:
   ````properties
   distributionUrl=https\://services.gradle.org/distributions/gradle-8.13-bin.zip
   ````

2. **ä¿®æ”¹build.gradle (æ ¹ç›®å½•)**:
   ````gradle
   classpath 'com.android.tools.build:gradle:8.13.1'
   ````

3. **é‡æ–°åŒæ­¥**:
   ````bash
   ./gradlew --stop
   ./gradlew assembleDebug
   ````

---

### Q2: æ‰¾ä¸åˆ°Javaç¯å¢ƒ

**ç°è±¡**:
````
Unable to locate a Java Runtime.
````

**è§£å†³æ–¹æ¡ˆ**:

è®¾ç½®JAVA_HOMEç¯å¢ƒå˜é‡:
````bash
export JAVA_HOME="/Applications/Android Studio.app/Contents/jbr/Contents/Home"
./gradlew assembleDebug
````

---

### Q3: gradle-wrapper.jaræŸå

**ç°è±¡**:
````
ClassNotFoundException: org.gradle.wrapper.GradleWrapperMain
````

**åŸå› **: gradle-wrapper.jaræ–‡ä»¶æŸåæˆ–ä¸å®Œæ•´

**è§£å†³æ–¹æ¡ˆ**:

é‡æ–°ä¸‹è½½wrapper:
````bash
curl -L -o gradle/wrapper/gradle-wrapper.jar \
  https://raw.githubusercontent.com/gradle/gradle/master/gradle/wrapper/gradle-wrapper.jar
````

---

### Q4: ç¼ºå°‘åº”ç”¨å›¾æ ‡

**ç°è±¡**:
````
error: resource mipmap/ic_launcher not found
````

**è§£å†³æ–¹æ¡ˆ**:

ä½¿ç”¨ImageMagickç”Ÿæˆå›¾æ ‡:
````bash
# åˆ›å»ºmipmapç›®å½•
mkdir -p app/src/main/res/mipmap-{mdpi,hdpi,xhdpi,xxhdpi,xxxhdpi}

# ç”Ÿæˆä¸åŒå°ºå¯¸çš„å›¾æ ‡
convert -size 48x48 xc:#4CAF50 -gravity center -pointsize 24 \
  -fill white -annotate +0+0 "W" app/src/main/res/mipmap-mdpi/ic_launcher.png

convert -size 72x72 xc:#4CAF50 -gravity center -pointsize 36 \
  -fill white -annotate +0+0 "W" app/src/main/res/mipmap-hdpi/ic_launcher.png

convert -size 96x96 xc:#4CAF50 -gravity center -pointsize 48 \
  -fill white -annotate +0+0 "W" app/src/main/res/mipmap-xhdpi/ic_launcher.png

convert -size 144x144 xc:#4CAF50 -gravity center -pointsize 72 \
  -fill white -annotate +0+0 "W" app/src/main/res/mipmap-xxhdpi/ic_launcher.png

convert -size 192x192 xc:#4CAF50 -gravity center -pointsize 96 \
  -fill white -annotate +0+0 "W" app/src/main/res/mipmap-xxxhdpi/ic_launcher.png

# å¤åˆ¶ä¸ºroundå›¾æ ‡
for dir in mdpi hdpi xhdpi xxhdpi xxxhdpi; do
  cp app/src/main/res/mipmap-$dir/ic_launcher.png \
     app/src/main/res/mipmap-$dir/ic_launcher_round.png
done
````

---

## ğŸ“± çœŸæœºè¿æ¥é—®é¢˜

### Q5: æ— æ³•è¿æ¥çœŸæœº

**ç°è±¡**:
````
adb devices
List of devices attached
(ç©º)
````

**è§£å†³æ–¹æ¡ˆ**:

#### æ–¹æ³•1: æ— çº¿ADB (æ¨è)

1. **æ‰‹æœºç«¯è®¾ç½®**:
   ````
   è®¾ç½® -> ç³»ç»Ÿ -> å¼€å‘è€…é€‰é¡¹ -> æ— çº¿è°ƒè¯• (æ‰“å¼€)
   ````

2. **é¦–æ¬¡é…å¯¹** (åªéœ€ä¸€æ¬¡):
   ````bash
   # æ‰‹æœºä¸Šç‚¹å‡»"ä½¿ç”¨é…å¯¹ç é…å¯¹è®¾å¤‡"
   # è®°ä¸‹é…å¯¹ç ã€IPå’Œç«¯å£
   adb pair 192.168.1.3:37859
   # è¾“å…¥é…å¯¹ç 
   ````

3. **æ—¥å¸¸è¿æ¥**:
   ````bash
   adb connect 192.168.1.3:41239
   ````

#### æ–¹æ³•2: USBè¿æ¥

1. å¼€å¯USBè°ƒè¯•
2. è¿æ¥æ•°æ®çº¿
3. æ‰‹æœºä¸Šå…è®¸USBè°ƒè¯•

---

### Q6: è¿æ¥åæ— æ³•å®‰è£…

**ç°è±¡**:
````
adb: failed to install: Failure [INSTALL_FAILED_UPDATE_INCOMPATIBLE]
````

**è§£å†³æ–¹æ¡ˆ**:

å¸è½½æ—§ç‰ˆæœ¬åé‡æ–°å®‰è£…:
````bash
adb -s 192.168.1.3:41239 uninstall com.wechat.auto
adb -s 192.168.1.3:41239 install -r app/build/outputs/apk/debug/app-debug.apk
````

---

## ğŸ› åŠŸèƒ½é—®é¢˜

### Q7: ç‚¹å‡»æŒ‰é’®æ²¡ååº”

**ç°è±¡**: ç‚¹å‡»"å¯åŠ¨è‡ªåŠ¨åŒ–ä»»åŠ¡"æŒ‰é’®,æ²¡æœ‰ä»»ä½•ååº”

**å¯èƒ½åŸå› **:

1. **æŒ‰é’®è¢«ç¦ç”¨**
   - æ£€æŸ¥æ— éšœç¢æœåŠ¡æ˜¯å¦å·²å¼€å¯
   - çŠ¶æ€åº”æ˜¾ç¤º âœ…

2. **æ— éšœç¢æœåŠ¡æœªè¿è¡Œ**
   - é‡æ–°å¼€å¯æ— éšœç¢æœåŠ¡
   - æ€æ‰åº”ç”¨é‡æ–°æ‰“å¼€

**è§£å†³æ–¹æ¡ˆ**:

````bash
# æŸ¥çœ‹æ—¥å¿—
adb -s 192.168.1.3:41239 logcat | grep -E "MainActivity|WeChatAutoService"
````

---

### Q8: æç¤º"ä»»åŠ¡å·²å¯åŠ¨"ä½†å¾®ä¿¡æ²¡æ‰“å¼€

**ç°è±¡**: Toastæ˜¾ç¤º"è‡ªåŠ¨åŒ–ä»»åŠ¡å·²å¯åŠ¨",ä½†å¾®ä¿¡æ²¡æœ‰æ‰“å¼€

**åŸå› **: å¯åŠ¨å¾®ä¿¡çš„Intenté…ç½®é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:

ä½¿ç”¨ComponentNameç›´æ¥æŒ‡å®šActivity:
````java
Intent intent = new Intent();
intent.setComponent(new ComponentName(
    "com.tencent.mm",
    "com.tencent.mm.ui.LauncherUI"
));
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(intent);
````

**éªŒè¯å¾®ä¿¡åŒ…å**:
````bash
adb shell pm list packages | grep tencent
# åº”è¯¥çœ‹åˆ°: package:com.tencent.mm
````

---

### Q9: æ— éšœç¢æœåŠ¡æ— æ³•å¼€å¯

**ç°è±¡**: åœ¨è®¾ç½®ä¸­æ‰¾ä¸åˆ°WeChatAuto,æˆ–è€…å¼€å…³æ— æ³•æ‰“å¼€

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥é…ç½®æ–‡ä»¶**:
   - `AndroidManifest.xml`ä¸­æ˜¯å¦å£°æ˜äº†æœåŠ¡
   - `accessibility_service_config.xml`æ˜¯å¦å­˜åœ¨

2. **é‡æ–°å®‰è£…åº”ç”¨**:
   ````bash
   adb uninstall com.wechat.auto
   adb install app-debug.apk
   ````

3. **é‡å¯æ‰‹æœº**

---

### Q10: æ— éšœç¢æœåŠ¡é¢‘ç¹æ–­å¼€

**ç°è±¡**: æ— éšœç¢æœåŠ¡è‡ªåŠ¨å…³é—­

**å¯èƒ½åŸå› **:
- ç³»ç»Ÿçœç”µç­–ç•¥
- å†…å­˜ä¸è¶³è¢«æ€

**è§£å†³æ–¹æ¡ˆ**:

1. **å…³é—­çœç”µé™åˆ¶**:
   ````
   è®¾ç½® -> ç”µæ±  -> WeChatAuto -> æ— é™åˆ¶
   ````

2. **é”å®šåå°**:
   ````
   æœ€è¿‘ä»»åŠ¡ -> WeChatAuto -> é”å®š
   ````

3. **æ·»åŠ åˆ°ç™½åå•**:
   ````
   è®¾ç½® -> åº”ç”¨ç®¡ç† -> WeChatAuto -> è‡ªå¯åŠ¨ (å…è®¸)
   ````

---

## ï¿½ é€šè®¯å½•åŒæ­¥é—®é¢˜

### Q11: åŒæ­¥çš„å¥½å‹æ•°é‡ä¸å…¨

**ç°è±¡**: åŒæ­¥æ˜¾ç¤º540ä¸ªå¥½å‹,ä½†å®é™…æœ‰600+ä¸ªå¥½å‹

**åŸå› **:
1. **æœ€å¤§æ»šåŠ¨æ¬¡æ•°é™åˆ¶** - ä¹‹å‰è®¾ç½®ä¸º50æ¬¡,æ»šåŠ¨åˆ°50æ¬¡å°±åœæ­¢äº†
2. **æ»šåŠ¨å¤ªå¿«** - åˆ—è¡¨åŠ è½½ä¸åŠæ—¶,å¯¼è‡´è¯»å–é‡å¤æ•°æ®
3. **ç­‰å¾…æ—¶é—´ä¸å¤Ÿ** - æ»šåŠ¨åæ²¡æœ‰è¶³å¤Ÿæ—¶é—´è®©åˆ—è¡¨åŠ è½½

**è§£å†³æ–¹æ¡ˆ**:

âœ… **å·²ä¼˜åŒ–** (V0.3.1):
- æœ€å¤§æ»šåŠ¨æ¬¡æ•°: 50æ¬¡ â†’ 500æ¬¡
- æ»šåŠ¨æ—¶é•¿: 500ms â†’ 800ms
- ç­‰å¾…æ—¶é—´: 1000ms â†’ 1500ms
- åœæ­¢åˆ¤æ–­: è¿ç»­3æ¬¡æ— æ–°å¥½å‹ â†’ è¿ç»­5æ¬¡æ— æ–°å¥½å‹

**éªŒè¯æ–¹æ³•**:
```bash
# æŸ¥çœ‹åŒæ­¥æ—¥å¿—
adb -s 192.168.1.3:37139 logcat | grep "WeChatAutoService"

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼æ—¥å¿—:
# ç¬¬1æ¬¡è¯»å–: æœ¬æ¬¡æ‰¾åˆ°18ä¸ªå¥½å‹, æ–°å¢18ä¸ª, æ€»è®¡18ä¸ª
# ç¬¬2æ¬¡è¯»å–: æœ¬æ¬¡æ‰¾åˆ°26ä¸ªå¥½å‹, æ–°å¢10ä¸ª, æ€»è®¡28ä¸ª
# ...
# ç¬¬Næ¬¡è¯»å–: æœ¬æ¬¡æ‰¾åˆ°26ä¸ªå¥½å‹, æ–°å¢0ä¸ª, æ€»è®¡XXXä¸ª
# è¿ç»­5æ¬¡æ²¡æœ‰æ–°å¥½å‹
# å·²åˆ°è¾¾åˆ—è¡¨åº•éƒ¨
```

---

### Q12: ç‚¹å‡»"é…ç½®è‡ªåŠ¨åŒ–ä»»åŠ¡"é—ªé€€

**ç°è±¡**:
```
java.lang.ClassCastException: java.lang.String cannot be cast to java.util.Set
```

**åŸå› **:
- æ—§ç‰ˆæœ¬ä½¿ç”¨`StringSet`å­˜å‚¨å¥½å‹åˆ—è¡¨
- æ–°ç‰ˆæœ¬ä½¿ç”¨JSONå­—ç¬¦ä¸²å­˜å‚¨
- è¯»å–æ—¶ç±»å‹ä¸åŒ¹é…å¯¼è‡´å´©æºƒ

**è§£å†³æ–¹æ¡ˆ**:

âœ… **å·²ä¿®å¤** (V0.3.1):
```java
// å…¼å®¹æ€§è¯»å–é€»è¾‘
String friendsJson = prefs.getString("friends_list", null);
if (friendsJson != null) {
    // æ–°æ ¼å¼: JSONå­—ç¬¦ä¸²
    parseJsonFriends(friendsJson);
} else {
    // æ—§æ ¼å¼: StringSet
    Set<String> friendsSet = prefs.getStringSet("friends_list", null);
    if (friendsSet != null) {
        // è‡ªåŠ¨è½¬æ¢ä¸ºæ–°æ ¼å¼
        convertToJsonFormat(friendsSet);
    }
}
```

**ä¸´æ—¶è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…é™¤åº”ç”¨æ•°æ®
adb -s 192.168.1.3:37139 shell pm clear com.wechat.auto

# é‡æ–°åŒæ­¥é€šè®¯å½•
```

---

### Q13: å¥½å‹åˆ—è¡¨é¡ºåºæ··ä¹±

**ç°è±¡**: æ¯æ¬¡æ‰“å¼€å¥½å‹åˆ—è¡¨,é¡ºåºéƒ½ä¸ä¸€æ ·

**åŸå› **:
- `HashSet`æ— åº
- `StringSet`æ— åº
- æ²¡æœ‰æ’åºé€»è¾‘

**è§£å†³æ–¹æ¡ˆ**:

âœ… **å·²ä¿®å¤** (V0.3.0):
- ä½¿ç”¨JSONå­—ç¬¦ä¸²å­˜å‚¨,ä¿æŒé¡ºåº
- æŒ‰é¦–å­—æ¯æ’åº(å­—æ¯åœ¨å‰,ç‰¹æ®Šç¬¦å·åœ¨å)
- æ¨¡ä»¿å¾®ä¿¡çš„æ’åºè§„åˆ™

**æ’åºè§„åˆ™**:
1. å­—æ¯å¼€å¤´çš„åœ¨å‰ (A-Z, a-z)
2. ä¸­æ–‡åœ¨ä¸­é—´ (æŒ‰æ‹¼éŸ³é¦–å­—æ¯)
3. ç‰¹æ®Šç¬¦å·åœ¨å (#, @, ç­‰)

---

## ï¿½ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹å®æ—¶æ—¥å¿—

````bash
# æ¸…ç©ºæ—¥å¿—
adb -s 192.168.1.3:41239 logcat -c

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
adb -s 192.168.1.3:41239 logcat | grep -E "WeChatAuto|com.wechat.auto"

# åªçœ‹é”™è¯¯
adb -s 192.168.1.3:41239 logcat *:E | grep WeChatAuto
````

---

### æŸ¥çœ‹åº”ç”¨ä¿¡æ¯

````bash
# æ£€æŸ¥åº”ç”¨æ˜¯å¦å®‰è£…
adb shell pm list packages | grep wechat.auto

# æŸ¥çœ‹åº”ç”¨è¯¦ç»†ä¿¡æ¯
adb shell dumpsys package com.wechat.auto

# æŸ¥çœ‹åº”ç”¨æƒé™
adb shell dumpsys package com.wechat.auto | grep permission
````

---

### æ‰‹åŠ¨å¯åŠ¨åº”ç”¨

````bash
# å¯åŠ¨ä¸»Activity
adb shell am start -n com.wechat.auto/.MainActivity

# å¯åŠ¨å¾®ä¿¡
adb shell am start -n com.tencent.mm/.ui.LauncherUI
````

---

## ğŸ’¡ å¼€å‘å»ºè®®

### 1. ä¿æŒæ—¥å¿—è¾“å‡º

åœ¨å…³é”®ä½ç½®æ·»åŠ Log:
````java
Log.d(TAG, "å…³é”®æ“ä½œ: " + è¯¦ç»†ä¿¡æ¯);
Log.e(TAG, "é”™è¯¯ä¿¡æ¯: " + e.getMessage(), e);
````

### 2. ä½¿ç”¨Toaståé¦ˆ

è®©ç”¨æˆ·çŸ¥é“æ“ä½œç»“æœ:
````java
Toast.makeText(this, "æ“ä½œæˆåŠŸ", Toast.LENGTH_SHORT).show();
````

### 3. å¼‚å¸¸å¤„ç†

æ‰€æœ‰å¯èƒ½å‡ºé”™çš„åœ°æ–¹éƒ½è¦try-catch:
````java
try {
    // å¯èƒ½å‡ºé”™çš„ä»£ç 
} catch (Exception e) {
    Log.e(TAG, "æ“ä½œå¤±è´¥", e);
    Toast.makeText(this, "æ“ä½œå¤±è´¥: " + e.getMessage(), Toast.LENGTH_LONG).show();
}
````

### 4. å¿«é€Ÿè¿­ä»£

åˆ©ç”¨å‘½ä»¤è¡Œç¼–è¯‘,å®ç°ç§’çº§è¿­ä»£:
````bash
# ä¸€æ¡å‘½ä»¤å®Œæˆç¼–è¯‘å’Œå®‰è£…
export JAVA_HOME="/Applications/Android Studio.app/Contents/jbr/Contents/Home" && \
./gradlew assembleDebug && \
adb -s 192.168.1.3:41239 install -r app/build/outputs/apk/debug/app-debug.apk
````

---

## ğŸš€ è‡ªåŠ¨å‘é€æ¶ˆæ¯ç›¸å…³é—®é¢˜

### Q15: æœç´¢æŒ‰é’®å®šä½ä¸å‡†ç¡®

**ç°è±¡**:
ç‚¹å‡»"æœç´¢"å,æ‰“å¼€çš„ä¸æ˜¯å³ä¸Šè§’çš„æœç´¢æ¡†,è€Œæ˜¯å…¶ä»–æœç´¢åŠŸèƒ½ã€‚

**åŸå› **:
ä½¿ç”¨`findAccessibilityNodeInfosByText("æœç´¢")`æŸ¥æ‰¾,å¯èƒ½åŒ¹é…åˆ°å¤šä¸ªæœç´¢æŒ‰é’®ã€‚

**è§£å†³æ–¹æ¡ˆ**:

ä½¿ç”¨resource-idç²¾ç¡®å®šä½:
````java
// æ–¹æ³•1: é€šè¿‡resource-idæŸ¥æ‰¾ (æ¨è)
List<AccessibilityNodeInfo> nodes = rootNode.findAccessibilityNodeInfosByViewId("com.tencent.mm:id/jha");

// æ–¹æ³•2: é€šè¿‡content-descæŸ¥æ‰¾
nodes = rootNode.findAccessibilityNodeInfosByText("æœç´¢");
for (AccessibilityNodeInfo node : nodes) {
    if ("æœç´¢".equals(node.getContentDescription()) && node.isClickable()) {
        node.performAction(AccessibilityNodeInfo.ACTION_CLICK);
        break;
    }
}
````

**å…³é”®ç‚¹**:
- ä¼˜å…ˆä½¿ç”¨resource-id,æœ€ç²¾ç¡®
- ä½¿ç”¨content-descä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ
- é¿å…ä»…é€šè¿‡textæŸ¥æ‰¾,å®¹æ˜“è¯¯åŒ¹é…

---

### Q16: è¾“å…¥æ¡†å†²çªé—®é¢˜

**ç°è±¡**:
åœ¨æœç´¢æ¡†è¾“å…¥å¥½å‹åå,ç«‹å³è¢«æ¶ˆæ¯å†…å®¹è¦†ç›–ã€‚

**åŸå› **:
æœç´¢æ¡†å’ŒèŠå¤©è¾“å…¥æ¡†éƒ½æ˜¯EditText,ä½¿ç”¨ç¬¬ä¸€ä¸ªEditTextä¼šå®šä½åˆ°æœç´¢æ¡†ã€‚

**è§£å†³æ–¹æ¡ˆ**:

ä½¿ç”¨æœ€åä¸€ä¸ªEditTextä½œä¸ºèŠå¤©è¾“å…¥æ¡†:
````java
private void sendTextMessage(String text) {
    List<AccessibilityNodeInfo> editTexts = findNodesByClassName(rootNode, "android.widget.EditText");

    if (editTexts.isEmpty()) {
        Log.e(TAG, "æœªæ‰¾åˆ°è¾“å…¥æ¡†");
        return;
    }

    // ä½¿ç”¨æœ€åä¸€ä¸ªEditText (èŠå¤©è¾“å…¥æ¡†åœ¨åº•éƒ¨)
    AccessibilityNodeInfo chatEditText = editTexts.get(editTexts.size() - 1);

    // å…ˆè·å–ç„¦ç‚¹
    chatEditText.performAction(AccessibilityNodeInfo.ACTION_FOCUS);

    // å»¶è¿Ÿåè¾“å…¥æ–‡å­—
    handler.postDelayed(() -> {
        Bundle arguments = new Bundle();
        arguments.putCharSequence(AccessibilityNodeInfo.ACTION_ARGUMENT_SET_TEXT_CHARSEQUENCE, text);
        chatEditText.performAction(AccessibilityNodeInfo.ACTION_SET_TEXT, arguments);
    }, 500);
}
````

**å…³é”®ç‚¹**:
- èŠå¤©è¾“å…¥æ¡†åœ¨å±å¹•åº•éƒ¨,æ˜¯æœ€åä¸€ä¸ªEditText
- æœç´¢æ¡†åœ¨é¡¶éƒ¨,æ˜¯ç¬¬ä¸€ä¸ªEditText
- å…ˆè·å–ç„¦ç‚¹,å†å»¶è¿Ÿè¾“å…¥,ç¡®ä¿è¾“å…¥æˆåŠŸ

---

### Q17: å‘é€æŒ‰é’®ç‚¹å‡»å¤±è´¥

**ç°è±¡**:
æ–‡å­—è¾“å…¥æˆåŠŸ,ä½†æ²¡æœ‰ç‚¹å‡»å‘é€æŒ‰é’®,æ¶ˆæ¯æœªå‘é€ã€‚

**åŸå› **:
é€šè¿‡text="å‘é€"æŸ¥æ‰¾,ä½†æ²¡æœ‰éªŒè¯æ–‡å­—å®Œå…¨åŒ¹é…,å¯èƒ½åŒ¹é…åˆ°å…¶ä»–åŒ…å«"å‘é€"çš„æŒ‰é’®ã€‚

**è§£å†³æ–¹æ¡ˆ**:

ä½¿ç”¨resource-idå’Œç²¾ç¡®æ–‡å­—åŒ¹é…:
````java
private void clickSendButton() {
    AccessibilityNodeInfo rootNode = getRootInActiveWindow();
    if (rootNode == null) {
        Log.e(TAG, "æ— æ³•è·å–æ ¹èŠ‚ç‚¹");
        return;
    }

    // æ–¹æ³•1: é€šè¿‡resource-idæŸ¥æ‰¾ (æ¨è)
    List<AccessibilityNodeInfo> nodes = rootNode.findAccessibilityNodeInfosByViewId("com.tencent.mm:id/bql");
    if (nodes != null && !nodes.isEmpty()) {
        for (AccessibilityNodeInfo node : nodes) {
            if (node.isClickable() && "android.widget.Button".equals(node.getClassName())) {
                node.performAction(AccessibilityNodeInfo.ACTION_CLICK);
                Log.d(TAG, "ç‚¹å‡»å‘é€æŒ‰é’®æˆåŠŸ (é€šè¿‡resource-id)");
                return;
            }
        }
    }

    // æ–¹æ³•2: é€šè¿‡textæŸ¥æ‰¾ (å¤‡é€‰)
    nodes = rootNode.findAccessibilityNodeInfosByText("å‘é€");
    if (nodes != null && !nodes.isEmpty()) {
        for (AccessibilityNodeInfo node : nodes) {
            CharSequence text = node.getText();
            // ç²¾ç¡®åŒ¹é…æ–‡å­—
            if (text != null && "å‘é€".equals(text.toString()) && node.isClickable()) {
                node.performAction(AccessibilityNodeInfo.ACTION_CLICK);
                Log.d(TAG, "ç‚¹å‡»å‘é€æŒ‰é’®æˆåŠŸ (é€šè¿‡text)");
                return;
            }
        }
    }

    Log.w(TAG, "æœªæ‰¾åˆ°å‘é€æŒ‰é’®");
}
````

**å…³é”®ç‚¹**:
- ä¼˜å…ˆä½¿ç”¨resource-id: `com.tencent.mm:id/bql`
- éªŒè¯classNameæ˜¯Button
- ç²¾ç¡®åŒ¹é…æ–‡å­—: `"å‘é€".equals(text.toString())`
- ä¸è¦ä½¿ç”¨`contains("å‘é€")`,ä¼šè¯¯åŒ¹é…

---

### Q18: æ—¶é—´å»¶è¿Ÿè®¾ç½®ä¸å½“

**ç°è±¡**:
æ“ä½œæ‰§è¡Œè¿‡å¿«,UIè¿˜æ²¡åŠ è½½å®Œæˆå°±å¼€å§‹ä¸‹ä¸€æ­¥æ“ä½œ,å¯¼è‡´å¤±è´¥ã€‚

**åŸå› **:
ä¸åŒæ­¥éª¤çš„UIåŠ è½½æ—¶é—´ä¸åŒ,éœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å»¶è¿Ÿã€‚

**è§£å†³æ–¹æ¡ˆ**:

æ ¹æ®UIåŠ è½½æ—¶é—´è®¾ç½®åˆç†å»¶è¿Ÿ:

| æ­¥éª¤ | å»¶è¿Ÿæ—¶é—´ | è¯´æ˜ |
|------|---------|------|
| æ‰“å¼€å¾®ä¿¡ â†’ ç‚¹å‡»æœç´¢ | 1000ms | ç­‰å¾…å¾®ä¿¡ä¸»ç•Œé¢åŠ è½½ |
| ç‚¹å‡»æœç´¢ â†’ è¾“å…¥å¥½å‹å | 2500ms | ç­‰å¾…æœç´¢ç•Œé¢æ‰“å¼€ |
| è¾“å…¥å¥½å‹å â†’ ç‚¹å‡»ç»“æœ | 4000ms | ç­‰å¾…æœç´¢ç»“æœå‡ºç° |
| ç‚¹å‡»ç»“æœ â†’ å‘é€æ¶ˆæ¯ | **6000ms** | **å…³é”®**:ç­‰å¾…èŠå¤©ç•Œé¢å®Œå…¨åŠ è½½ |
| è¾“å…¥æ–‡å­— â†’ ç‚¹å‡»å‘é€ | 800ms | ç­‰å¾…æ–‡å­—è¾“å…¥å®Œæˆ |
| å‘é€æ¶ˆæ¯ â†’ ä¸‹ä¸€æ¡æ¶ˆæ¯ | 1000ms | ç­‰å¾…æ¶ˆæ¯å‘é€å®Œæˆ |

**å…³é”®ç‚¹**:
- èŠå¤©ç•Œé¢åŠ è½½æœ€æ…¢,éœ€è¦6ç§’å»¶è¿Ÿ
- æœç´¢ç»“æœå‡ºç°éœ€è¦4ç§’
- ä¸è¦è®¾ç½®å¤ªçŸ­,å®å¯å¤šç­‰ä¸€ä¼š
- å¯ä»¥æ ¹æ®å®é™…æµ‹è¯•è°ƒæ•´

---

### Q19: å¦‚ä½•è°ƒè¯•UIå®šä½é—®é¢˜

**é—®é¢˜**:
ä¸çŸ¥é“æŸä¸ªæŒ‰é’®çš„resource-idæˆ–content-descæ˜¯ä»€ä¹ˆã€‚

**è§£å†³æ–¹æ¡ˆ**:

ä½¿ç”¨adbå‘½ä»¤å¯¼å‡ºUIç»“æ„:
````bash
# 1. å¯¼å‡ºUIç»“æ„åˆ°æ‰‹æœº
adb -s 192.168.1.3:40099 shell uiautomator dump /sdcard/ui.xml

# 2. æ‹‰å–åˆ°ç”µè„‘
adb -s 192.168.1.3:40099 pull /sdcard/ui.xml /tmp/ui.xml

# 3. æŸ¥çœ‹UIç»“æ„
cat /tmp/ui.xml
````

**æŸ¥æ‰¾å…³é”®ä¿¡æ¯**:
````xml
<node
    text="å‘é€"
    resource-id="com.tencent.mm:id/bql"
    class="android.widget.Button"
    content-desc=""
    clickable="true"
    bounds="[598,1518][706,1598]"
/>
````

**å…³é”®å±æ€§**:
- `resource-id`: æœ€ç²¾ç¡®çš„å®šä½æ–¹å¼
- `content-desc`: æ— éšœç¢æè¿°,é€‚åˆå›¾æ ‡æŒ‰é’®
- `text`: æ–‡å­—å†…å®¹,é€‚åˆæ–‡å­—æŒ‰é’®
- `class`: æ§ä»¶ç±»å‹,ç”¨äºè¿‡æ»¤
- `clickable`: æ˜¯å¦å¯ç‚¹å‡»
- `bounds`: åæ ‡ä½ç½®(ä¸æ¨èä½¿ç”¨)

---

### Q20: æ¶ˆæ¯é‡å¤å‘é€æˆ–è·³è¿‡

**é—®é¢˜**:
å‘é€å¤šæ¡æ¶ˆæ¯æ—¶,ç¬¬ä¸€æ¡æ¶ˆæ¯å‘é€äº†2æ¬¡,ç¬¬äºŒæ¡æ¶ˆæ¯è¢«è·³è¿‡äº†ã€‚

**ç°è±¡**:
````
16:32:42.509  å‡†å¤‡è¾“å…¥æ–‡å­—: ä½ å¥½
16:32:42.860  è¾“å…¥æ–‡å­—æ¶ˆæ¯æˆåŠŸ: ä½ å¥½
16:32:42.884  è¾“å…¥æ–‡å­—æ¶ˆæ¯æˆåŠŸ: ä½ å¥½  â† é‡å¤äº†!
16:32:43.552  å‘é€ç¬¬ 2 æ¡æ¶ˆæ¯, ç±»å‹: image  â† è·³è¿‡äº†ç¬¬2æ¡æ–‡å­—!
````

**åŸå› **:
æ—§ä»£ç å’Œæ–°ä»£ç å†²çª:
- `searchFriend()`ä¸­å»¶è¿Ÿ6ç§’è°ƒç”¨`sendMessages()`(æ—§é€»è¾‘)
- `handleWindowStateChanged`è¿›å…¥èŠå¤©ç•Œé¢åè°ƒç”¨`sendTextMessage()`(æ–°é€»è¾‘)
- å¯¼è‡´ç¬¬ä¸€æ¡æ¶ˆæ¯è¢«å‘é€2æ¬¡,ç´¢å¼•+1åè·³è¿‡ç¬¬äºŒæ¡æ¶ˆæ¯

**è§£å†³æ–¹æ¡ˆ**:

åˆ é™¤`searchFriend()`ä¸­çš„æ—§ä»£ç è°ƒç”¨:
````java
private void searchFriend(String friendName) {
    Log.d(TAG, "å¼€å§‹æœç´¢å¥½å‹: " + friendName);
    taskState = TaskState.SEARCHING_FRIEND;

    // 1. ç‚¹å‡»æœç´¢æŒ‰é’®
    new Handler(Looper.getMainLooper()).postDelayed(() -> {
        clickSearchButton();
    }, 1000);

    // 2. è¾“å…¥å¥½å‹æ˜µç§°
    new Handler(Looper.getMainLooper()).postDelayed(() -> {
        inputSearchText(friendName);
    }, 2500);

    // 3. ç‚¹å‡»æœç´¢ç»“æœ
    new Handler(Looper.getMainLooper()).postDelayed(() -> {
        clickSearchResult(friendName);
    }, 4000);

    // æ³¨æ„: ä¸åœ¨è¿™é‡Œè°ƒç”¨sendMessages(),ç”±handleWindowStateChangedè´Ÿè´£å‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯
}
````

**å…³é”®ç‚¹**:
- åˆ é™¤å»¶è¿Ÿ6ç§’è°ƒç”¨`sendMessages()`çš„ä»£ç 
- å®Œå…¨ç”±`handleWindowStateChanged`è´Ÿè´£å‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯
- `clickSendButton`è°ƒç”¨`continueNextMessage`å‘é€åç»­æ¶ˆæ¯
- é€»è¾‘æ¸…æ™°,ä¸ä¼šé‡å¤æˆ–è·³è¿‡

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¼€å‘æŒ‡å—](./å¼€å‘æŒ‡å—.md) - å¼€å‘æµç¨‹å’Œè§„èŒƒ
- [è‡ªåŠ¨åŒ–æ–‡æ¡£](./è‡ªåŠ¨åŒ–æ–‡æ¡£.md) - æŠ€æœ¯å®ç°è¯¦è§£
- [README](../README.md) - é¡¹ç›®æ€»è§ˆ

---

[è¿”å›README](../README.md)
